port: 4222

jetstream {
  store_dir: "/data/jetstream"
}

# ============================================================
# Decentralized JWT Authentication
# ============================================================
# Generate these values once with: go run cmd/nats-setup/main.go
# Then store them in your .env file or docker-compose environment.
#
# How it works:
# - Operator JWT is the root of trust (signs account JWTs)
# - APP account has JetStream enabled for log storage
# - Clients connect using user JWTs signed by NATS_ACCOUNT_SEED
# - Server connects using NATS_SERVER_USER_JWT/SEED (in APP account)
# - System account is for NATS internal monitoring (no JetStream)
# ============================================================

# Operator JWT - root of trust, signs account JWTs
operator: $NATS_OPERATOR_JWT

# Memory resolver - preload account JWTs
resolver: MEMORY
resolver_preload: {
  # APP account - for client/server connections, has JetStream
  $NATS_ACCOUNT_PUBLIC_KEY: $NATS_ACCOUNT_JWT
  # System account - for NATS internal monitoring
  $NATS_SYSTEM_ACCOUNT_PUBLIC_KEY: $NATS_SYSTEM_ACCOUNT_JWT
}

# System account for NATS internal monitoring
system_account: $NATS_SYSTEM_ACCOUNT_PUBLIC_KEY
