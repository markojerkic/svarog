services:
  svarog-mongodb:
    image: mongo:7.0
    container_name: svarog-mongodb
    ports:
      - 27017:27017
    environment:
      - MONGODB_INITDB_ROOT_USERNAME=user
      - MONGODB_INITDB_ROOT_PASSWORD=pass
    volumes:
      - dbdata:/data/db
  nats:
    image: nats:latest
    container_name: svarog-nats
    ports:
      - "4222:4222"
    command: ["--config", "/config/nats-server.conf"]
    volumes:
      - ./nats-server.conf:/config/nats-server.conf:ro
      - nats_data:/data/jetstream
    environment:
      - NATS_OPERATOR_JWT=${NATS_OPERATOR_JWT}
      - NATS_ACCOUNT_PUBLIC_KEY=${NATS_ACCOUNT_PUBLIC_KEY}
      - NATS_ACCOUNT_JWT=${NATS_ACCOUNT_JWT}
      - NATS_SYSTEM_ACCOUNT_PUBLIC_KEY=${NATS_SYSTEM_ACCOUNT_PUBLIC_KEY}
      - NATS_SYSTEM_ACCOUNT_JWT=${NATS_SYSTEM_ACCOUNT_JWT}
    restart: unless-stopped
volumes:
  dbdata:
  nats_data:
